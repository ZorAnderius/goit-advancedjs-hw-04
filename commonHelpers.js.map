{"version":3,"file":"commonHelpers.js","sources":["../src/js/refs.js","../src/js/api.js","../src/js/notification.js","../src/js/drawHTML.js","../src/js/common.js","../src/js/handlers_infinity.js","../src/js/main.js"],"sourcesContent":["export const refs = {\n    form: document.querySelector('#search-form'),\n    galleryContainer: document.querySelector('.gallery'),\n    btnLoadMore: document.querySelector('.js-load'),\n\n    guardScroll: document.querySelector('.js-guard')\n}","import axios from \"axios\";\n\nconst API_KEY = '36805938-0e5858f236185e483726e7849';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nconst default_params = {\n    key: API_KEY,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n}\n\nexport const fetchImages = async (search_word, page = 1, per_page) => {\n    if (search_word) {\n        const { data } = await axios({\n            method: 'GET',\n            params: {\n                ...default_params,\n                q: search_word,\n                per_page,\n                page\n            }\n    })\n    return data;\n    }\n}\n","import iziToast from \"izitoast\";\n\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst option = {\n    position: 'topRight',\n    timeout: 3500\n}\n\nexport const showSuccessNotification = (message) => iziToast.success({\n    ...option,\n    message\n});\n\nexport const showInfo = (message) => iziToast.info({\n    ...option,\n    message\n});\n\n\nexport const showError = (message) => iziToast.error({\n    ...option,\n    title: 'Opps!',\n    message\n});","export const drawHTML = (elem, data) => {\n    elem.insertAdjacentHTML('beforeend', createItemCard(data))\n}\n\nfunction createItemCard(cards) {\n    return cards.map(({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads }) => `\n    <a class=\"link\" href=\"${largeImageURL}\">\n        <div class=\"photo-card\">\n        <div class=\"img-link\">\n            <img class=\"item-img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        </div>\n        <div class=\"info\">\n            <div class=\"info-item-wrap\">\n                <p class=\"info-item\">\n                    <b>Likes</b>\n                </p>\n                <p>\n                ${likes}\n                </p>\n            </div>\n            <div class=\"info-item-wrap\">\n                <p class=\"info-item\">\n                    <b>Views</b>\n                </p>\n\n                <p>\n                    ${views}\n                </p>\n            </div>\n            <div class=\"info-item-wrap\">\n                <p class=\"info-item\">\n                    <b>Comments</b>\n                </p>\n                <p>\n                    ${comments}\n                </p>\n            </div>\n            <div class=\"info-item-wrap\">\n                <p class=\"info-item\">\n                    <b>Downloads</b>\n                </p>\n                <p>\n                    ${downloads}\n                </p>\n            </div>\n        </div>\n    </div>\n    </a>\n`).join('');\n}\n\n\n","import { refs } from \"./refs\";\n\nexport const slowScroll = () => {\n  if (refs.galleryContainer.firstElementChild) {\n    const { height: cardHeight } = refs.galleryContainer.firstElementChild.getBoundingClientRect();\n\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n  } else {\n    window.scrollTo(0, 0);\n  }\n}\n\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { fetchImages } from \"./api\";\nimport { showError, showInfo, showSuccessNotification } from \"./notification\";\nimport { drawHTML } from \"./drawHTML\";\nimport { refs } from \"./refs\";\nimport { slowScroll } from \"./common\";\n\nconst per_page = 40;\nlet page = 1;\nlet currentInput = '';\n\nlet optionIntersection = {\n    root: null,\n    rootMargin: \"300px\",\n}\n\nconst observer = new IntersectionObserver(handlerLoadMore, optionIntersection);\n\nconst lightBox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 350,\n});\n\n\nexport const handlerSubmit = async (e) => {\n    e.preventDefault();\n    const value = e.target.elements[0].value.trim().toLowerCase();\n    try {\n        if (isValid(value)) {\n            cleanAll();\n            const { total, totalHits, hits } = await fetchImages(value, page, per_page);\n            if (!total) {\n                showInfo(\"Sorry, there are no images matching your search query. Please try again.\");\n                return;\n            } \n            drawHTML(refs.galleryContainer, hits);\n            addObserver(totalHits);\n            lightBox.refresh();\n            showSuccessNotification(`Hooray! We found ${totalHits} images.`);\n        }\n    } catch (error) {\n        cleanAll();\n        refs.form.reset();\n        showError(error.message ? error.message : error)\n    }\n}\n\nasync function handlerLoadMore(entries) {\n    entries.forEach(async entry => {\n        if (entry.isIntersecting) {\n            page++;\n            slowScroll();\n            const data = await fetchImages(currentInput, page, per_page);\n            drawHTML(refs.galleryContainer, data.hits);\n            lightBox.refresh();\n            const totalPages = Math.ceil(data.totalHits / per_page);\n            if (page >= totalPages) {\n                observer.unobserve(refs.guardScroll);\n                showSuccessNotification(\"We're sorry, but you've reached the end of search results.\");\n            }\n        }\n    });\n    \n}\n\nfunction isValid(inputValue) {\n    if (!!currentInput && !!inputValue && currentInput === inputValue) {\n        return false;\n    }\n\n    if (!!inputValue) {\n        currentInput = inputValue;\n        return true;\n    } else {\n        throw new Error('Invalid data');\n    }\n}\n\nfunction addObserver(totalHits) {\n    const totalPages = Math.ceil(totalHits / per_page);\n    if (page < totalPages) {\n        observer.observe(refs.guardScroll);\n    }\n}\n\nfunction cleanAll() {\n    refs.galleryContainer.innerHTML = '';\n    observer.unobserve(refs.guardScroll);\n    page = 1;\n}","import { refs } from \"./refs\";\n//infinity scroll\nimport { handlerSubmit } from \"./handlers_infinity\";\n\n//load more button\n// import { handlerSubmit } from \"./handlers_load_more\";\n\nrefs.form.addEventListener('submit', handlerSubmit);\n"],"names":["refs","API_KEY","axios","default_params","fetchImages","search_word","page","per_page","data","option","showSuccessNotification","message","iziToast","showInfo","showError","drawHTML","elem","createItemCard","cards","largeImageURL","webformatURL","tags","likes","views","comments","downloads","slowScroll","cardHeight","currentInput","optionIntersection","observer","handlerLoadMore","lightBox","SimpleLightbox","handlerSubmit","value","isValid","cleanAll","total","totalHits","hits","addObserver","error","entries","entry","totalPages","inputValue"],"mappings":"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"}